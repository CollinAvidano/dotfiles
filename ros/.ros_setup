# Exported Environment variables
#export PATH="$PATH:/usr/share/colcon_cd/function"
#. /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash


export ROS_LOCALHOST_ONLY=1


export WEBOTS_HOME=/usr/local/webots
export WEBOTS_LIBRARY_PATH=/home/collin/documents/ros/dual_arm_ws/devel/lib/webots_sim_driver
export WEBOTS_PROJECT=/home/collin/documents/ros/dual_arm_ws/src/dual_arm_control/hardware/webots_sim_driver

#export CATKIN_WS=~/documents/ros/test_ws
export CATKIN_WS=~/temp/test-ws

export COLCON_WS=~/documents/ateam/software_ws
export COLCON_WS=~/documents/ateam/temp_ws
#export COLCON_WS=~/documents/slam-suit/slam_suit_ws


# Useful Aliases
alias rosdep-install="rosdep install --from-paths src --ignore-src -r -y"
alias colcon-clean="cd $COLCON_WS && rm build install"
#alias cdws="cd $CATKIN_WS"

colcon-test-pkg () {
    #cd $COLCON_WS && colcon build --packages-select $1 && source install/setup.$SHELL_EXTENSION
    colcon test --packages-select $1
    colcon test-result --verbose --test-result-base build/$1
    #if [ cd $COLCON_WS && colcon build ]; then
        #colcon test --packages-skip $1
        #colcon test-result --verbose --test-result-base build/$1
    #fi
}



catkin-build() {
    cd $CATKIN_WS && catkin build $@ && source devel/setup.$SHELL_EXTENSION
    cd -
}

catkinbuild() {
    catkin-build $@
}

catkin-build-debug() {
    cd $CATKIN_WS && catkin build --cmake-args -DCMAKE_BUILD_TYPE=Debug $@ && source devel/setup.$SHELL_EXTENSION
    cd -
}

catkinbuilddebug() {
    catkin-build-debug $@
}

catkin-make() {
    cd $CATKIN_WS && catkin_make && source devel/setup.$SHELL_EXTENSION
    cd -
}

catkin-clean() {
    cd $CATKIN_WS && catkin clean
    cd -
}



colcon-build() {
    cd $COLCON_WS && colcon build --symlink-install --packages-select $@ && source install/setup.$SHELL_EXTENSION
    cd -
}

colcon-build-all() {
    cd $COLCON_WS && colcon build --symlink-install && source install/setup.$SHELL_EXTENSION
    cd -
}

colcon-build-debug() {
    cd $COLCON_WS && colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Debug --packages-select $@ && source install/setup.$SHELL_EXTENSION
    cd -
}

colcon-build-debug-all() {
    cd $COLCON_WS && colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Debug && source install/setup.$SHELL_EXTENSION
    cd -
}

setup-melodic() {
    source /opt/ros/melodic/setup.$SHELL_EXTENSION
    source $CATKIN_WS/devel/setup.$SHELL_EXTENSION
}

setup-noetic() {
    source /opt/ros/noetic/setup.$SHELL_EXTENSION
    source $CATKIN_WS/devel/setup.$SHELL_EXTENSION
}

setup-colcon-cd() {
    if [ ! -r /usr/share/colcon_cd/function/ ] || [ ! -x /usr/share/colcon_cd/function/ ]; then
        echo "setting perms on /usr/share/colcon_cd/function/"
        sudo chmod -R o+xr /usr/share/colcon_cd/function/
    fi 
    /usr/share/colcon_cd/function/colcon_cd.sh
    alias colconcd="colcon_cd"
}

setup-humble() {
    export ROS_DISTRO="humble"
    source /opt/ros/humble/setup.$SHELL_EXTENSION
    source $COLCON_WS/install/setup.$SHELL_EXTENSION

    eval "$(register-python-argcomplete3 ros2)"
    eval "$(register-python-argcomplete3 colcon)"

    export _colcon_cd_root=$COLCON_WS
    setup-colcon-cd

    alias rostopic="ros2 topic"
    alias roslaunch="ros2 launch"

    alias cdws="cd $COLCON_WS"
}

#Useful Functions
ros2-color() {
    ros2 $@ | grep --color -e ".*FATAL.*" --color -e ".*ERROR.*" -e "^"
}


#setup-melodic
#setup-noetic
#setup-foxy
#setup-galactic
setup-humble
